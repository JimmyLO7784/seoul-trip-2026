<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#F2F1F6">
    <meta name="format-detection" content="telephone=no">
    <title>é¦–çˆ¾ 2026 å¯’å†¬æ”»ç•¥</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;500;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* --- 1. æ ¸å¿ƒè®Šæ•¸ --- */
        :root {
            --bg: #F2F1F6;
            --surface: #FFFFFF;
            --primary: #C8A47E; /* å¥¶èŒ¶è‰² */
            --primary-dark: #A68665;
            --text-main: #1C1C1E;
            --text-sub: #8E8E93;
            --border: #E5E5EA;
            
            --accent-green: #34C759; 
            --accent-red: #FF3B30;
            --accent-blue: #007AFF;
            
            --radius: 18px;
            --shadow: 0 2px 8px rgba(0,0,0,0.04);
            
            --safe-top: env(safe-area-inset-top, 20px);
            --safe-bottom: env(safe-area-inset-bottom, 20px);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            margin: 0; padding: 0;
            background-color: #E0E0E0;
            color: var(--text-main);
            font-family: -apple-system, BlinkMacSystemFont, "M PLUS Rounded 1c", "Segoe UI", Roboto, sans-serif;
            font-size: 15px;
            line-height: 1.5;
            overscroll-behavior-y: none;
            user-select: none;
            -webkit-user-select: none;
        }

        /* --- 2. æ‰‹æ©Ÿæ¨¡æ“¬å®¹å™¨ --- */
        .app-container {
            max-width: 480px;
            margin: 0 auto;
            background-color: var(--bg);
            min-height: 100vh;
            position: relative;
            box-shadow: 0 0 40px rgba(0,0,0,0.1);
            padding-bottom: calc(70px + var(--safe-bottom));
        }

        /* --- 3. Header --- */
        header {
            position: sticky; top: 0; z-index: 1000;
            background: rgba(242, 241, 246, 0.9);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            padding: calc(12px + var(--safe-top)) 20px 12px 20px;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 0.5px solid rgba(0,0,0,0.1);
        }
        h1 { margin: 0; font-size: 22px; font-weight: 800; letter-spacing: 0.5px; }

        /* --- 4. Main Content Area --- */
        main { padding: 10px 16px; }

        /* --- 5. å…ƒä»¶æ¨£å¼ --- */
        .ios-card {
            background: var(--surface);
            border-radius: var(--radius);
            overflow: hidden;
            margin-bottom: 16px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(0,0,0,0.02);
        }
        
        /* åˆ—è¡¨é …ç›® */
        .ios-list-item {
            padding: 16px;
            display: flex; 
            align-items: flex-start;
            justify-content: space-between;
            background: var(--surface);
            border-bottom: 0.5px solid rgba(0,0,0,0.08);
            text-decoration: none; color: inherit;
            cursor: pointer;
            transition: background 0.2s;
            position: relative;
        }
        .ios-list-item:last-child { border-bottom: none; }
        .ios-list-item:active { background: #F2F2F7; }

        .item-left { flex: 1; min-width: 0; margin-right: 12px; }
        
        /* å³å´å®¹å™¨èª¿æ•´ï¼Œé©æ‡‰æŒ‰éˆ• */
        .item-right { 
            flex-shrink: 0; text-align: right; 
            display: flex; flex-direction: column; align-items: flex-end; gap: 6px; 
        }

        .item-title { font-weight: 700; font-size: 16px; margin-bottom: 4px; line-height: 1.3; }
        .item-desc { font-size: 13px; color: var(--text-sub); line-height: 1.4; display: block; }
        
        .time-badge { 
            font-size: 12px; font-weight: 700; color: var(--text-sub); 
            background: #F2F2F7; padding: 4px 8px; border-radius: 6px; 
            display: inline-block; white-space: nowrap;
        }

        /* è¤‡è£½åœ°å€æŒ‰éˆ• (æ–°åŠŸèƒ½) */
        .addr-btn {
            font-size: 11px; color: var(--text-sub); background: #F2F2F7;
            padding: 4px 8px; border-radius: 6px; border: 1px solid rgba(0,0,0,0.05);
            display: flex; align-items: center; gap: 4px; cursor: pointer;
            transition: all 0.2s; z-index: 10;
        }
        .addr-btn:active { background: #E5E5EA; transform: scale(0.95); color: var(--text-main); }
        .addr-btn i { font-size: 10px; }

        /* å“ç‰Œæ¨™ç±¤ */
        .brand-list { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 8px; }
        .brand-tag { 
            font-size: 11px; background: #F9F9F9; border: 1px solid #E5E5EA;
            padding: 3px 8px; border-radius: 6px; color: var(--text-main); font-weight: 600; 
        }
        .tag-must { border-color: var(--primary); color: var(--primary-dark); background: #FFF9F2; }

        /* Tags */
        .tag { font-size: 11px; padding: 4px 8px; border-radius: 6px; font-weight: 700; white-space: nowrap; }
        .tag-res { background: #E4F9E9; color: #34C759; }
        .tag-wait { background: #FFEBEA; color: #FF3B30; }
        .tag-app { background: #E7F3FF; color: #007AFF; }

        /* --- 6. å¤©æ°£å¡ç‰‡ --- */
        .weather-card {
            background: linear-gradient(135deg, #6DD5FA 0%, #2980B9 100%);
            color: white; padding: 20px; border-radius: 20px;
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 20px; margin-top: 10px;
            box-shadow: 0 8px 20px rgba(41, 128, 185, 0.3);
        }
        .wc-info { display: flex; flex-direction: column; }
        .wc-temp { font-size: 32px; font-weight: 800; line-height: 1; margin-bottom: 4px; }
        .wc-desc { font-size: 14px; opacity: 0.9; font-weight: 500; }
        .wc-icon { font-size: 40px; opacity: 0.9; }

        /* --- 7. æ—¥æœŸæ»‘å¡Š --- */
        .day-slider-container {
            position: sticky; top: calc(60px + var(--safe-top));
            z-index: 900; background: var(--bg);
            margin: 0 -16px 10px -16px; padding: 10px 16px;
            mask-image: linear-gradient(to right, black 90%, transparent 100%);
            -webkit-mask-image: linear-gradient(to right, black 90%, transparent 100%);
        }
        .day-slider { display: flex; overflow-x: auto; gap: 8px; scrollbar-width: none; }
        .day-slider::-webkit-scrollbar { display: none; }
        
        .day-chip {
            flex: 0 0 auto; min-width: 64px;
            background: var(--surface); border-radius: 14px; padding: 10px;
            text-align: center; cursor: pointer; transition: all 0.2s;
            border: 1px solid transparent; color: var(--text-sub);
            box-shadow: 0 2px 6px rgba(0,0,0,0.03);
        }
        .day-chip.active {
            background: var(--text-main); color: white;
            transform: scale(1.05); box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .day-chip-num { font-size: 11px; margin-bottom: 2px; opacity: 0.8; font-weight: 700; }
        .day-chip-date { font-size: 16px; font-weight: 800; }

        /* --- 8. Bottom Nav --- */
        nav {
            position: fixed; bottom: 0; left: 0; right: 0; z-index: 1000;
            max-width: 480px; margin: 0 auto;
            background: rgba(255,255,255,0.9); backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 0.5px solid rgba(0,0,0,0.15);
            padding-bottom: var(--safe-bottom);
            height: calc(60px + var(--safe-bottom));
            display: flex; justify-content: space-around; align-items: center;
        }
        .nav-btn {
            border: none; background: none; flex: 1; height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            gap: 4px; color: #999; cursor: pointer;
        }
        .nav-btn.active { color: var(--primary-dark); }
        .nav-btn i { font-size: 20px; transition: transform 0.2s; }
        .nav-btn.active i { transform: translateY(-2px); }
        .nav-btn span { font-size: 10px; font-weight: 600; }

        /* --- 9. Calc View --- */
        .calc-display {
            background: var(--surface); border-radius: 20px; padding: 24px;
            text-align: right; margin-bottom: 16px; box-shadow: var(--shadow);
        }
        .calc-input {
            width: 100%; border: none; background: transparent; text-align: right;
            font-size: 48px; font-weight: 300; color: var(--text-main); outline: none;
            font-family: -apple-system, monospace; margin: 8px 0;
        }
        .result-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 12px 0; border-top: 0.5px solid rgba(0,0,0,0.08);
        }
        .result-val { font-size: 20px; font-weight: 700; font-family: monospace; }

        /* --- 10. Utils --- */
        .hidden { display: none !important; }
        .section-header { font-size: 20px; font-weight: 800; margin: 24px 0 12px 4px; color: var(--text-main); }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .grid-card {
            background: var(--surface); border-radius: var(--radius); padding: 20px;
            text-align: center; box-shadow: var(--shadow); cursor: pointer;
        }
        .grid-card:active { transform: scale(0.96); background: #FAFAFA; }

        /* Modal & Toast */
        .modal-overlay {
            position: absolute; inset: 0; background: rgba(0,0,0,0.4); backdrop-filter: blur(4px);
            z-index: 2000; display: none; align-items: flex-end; justify-content: center;
            padding-bottom: var(--safe-bottom);
        }
        .modal-overlay.show { opacity: 1; }
        .modal-content {
            background: var(--surface); width: 95%; border-radius: 24px; padding: 30px 20px;
            text-align: center; margin-bottom: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
        @keyframes slideUp { from {transform: translateY(100%);} to {transform: translateY(0);} }
        .modal-btn {
            background: var(--text-main); color: white; border: none; padding: 14px;
            width: 100%; border-radius: 14px; font-size: 16px; font-weight: 700; margin-top: 24px;
        }
        #toast {
            position: fixed; top: 90px; left: 50%; transform: translateX(-50%) translateY(-20px);
            background: rgba(0,0,0,0.85); color: white; padding: 10px 20px; border-radius: 30px;
            font-size: 13px; font-weight: 600; opacity: 0; transition: all 0.3s; 
            pointer-events: none; z-index: 3000; display: flex; align-items: center; gap: 8px;
        }
        #toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

    </style>
</head>
<body>

<div class="app-container">
    <header>
        <h1>SEOUL 2026</h1>
        <div style="font-size:12px; font-weight:600; color:var(--text-sub);">
            1/25 - 1/30
        </div>
    </header>

    <div id="toast"><i class="fa-solid fa-check-circle"></i> <span>å·²è¤‡è£½åœ°å€</span></div>

    <main>
        <div id="view-plan">
            
            <div class="weather-card" id="weather-card" onclick="updateWeather()">
                <div class="wc-info">
                    <span class="wc-temp" id="wc-temp">--Â°</span>
                    <span class="wc-desc" id="wc-desc">è¼‰å…¥å¤©æ°£ä¸­...</span>
                    <span style="font-size:11px; opacity:0.7; margin-top:4px;">é»æ“Šé‡æ–°æ•´ç†</span>
                </div>
                <div class="wc-icon">
                    <i class="fa-solid fa-cloud" id="wc-icon"></i>
                </div>
            </div>

            <div class="day-slider-container">
                <div class="day-slider" id="day-slider"></div>
            </div>
            <div id="day-content" style="padding-bottom: 20px;"></div>
        </div>

        <div id="view-calc" class="hidden">
            <div class="section-header">åŒ¯ç‡è¨ˆç®—</div>
            <div class="ios-card" style="padding:16px; background:#FAFAFA; border:none;">
                <div style="font-size:13px; font-weight:600; color:var(--text-sub);">ç•¶å‰åŒ¯ç‡ (TWD)</div>
                <div style="font-size:14px; margin-top:4px;">1 KRW â‰ˆ <span id="rate-display" style="font-weight:700;">0.0235</span></div>
            </div>

            <div class="calc-display">
                <div style="font-size:13px; color:var(--text-sub); font-weight:600; display:flex; justify-content:space-between;">
                    <span>è¼¸å…¥éŸ“å¹£ (KRW)</span>
                    <span onclick="resetCalc()" style="color:var(--primary); cursor:pointer;">æ¸…é™¤</span>
                </div>
                <input type="text" inputmode="decimal" id="calc-input" class="calc-input" placeholder="0" oninput="calculateAll()">
                
                <div class="result-row">
                    <span style="color:var(--text-sub);">ç´„åˆå°å¹£</span>
                    <span class="result-val" id="res-twd">0</span>
                </div>
                <div class="result-row" style="border-top:none; padding-top:0;">
                    <span style="color:var(--text-sub);">é è¨ˆé€€ç¨…</span>
                    <span class="result-val" style="color:var(--accent-green);" id="res-tax">0</span>
                </div>
            </div>
            <div style="text-align:center; font-size:12px; color:var(--text-sub); line-height:1.6;">
                <i class="fa-solid fa-circle-info"></i> å–®ç­†æ»¿ 30,000 éŸ“å…ƒå³å¯é€€ç¨…
            </div>
        </div>

        <div id="view-guide" class="hidden">
            <div class="section-header">ç”Ÿå­˜æºé€šå¡</div>
            <div class="grid-2">
                <div class="grid-card" onclick="openModal('ì•ˆë…•í•˜ì„¸ìš”','ä½ å¥½ (å®‰å¦å“ˆã„™ã„Ÿå‘¦)')"><span class="grid-icon">ğŸ‘‹</span><div class="grid-title">ä½ å¥½</div></div>
                <div class="grid-card" onclick="openModal('ê°ì‚¬í•©ë‹ˆë‹¤','è¬è¬ (åº·æ’’å“ˆå’ªæ­)')"><span class="grid-icon">ğŸ™</span><div class="grid-title">è¬è¬</div></div>
                <div class="grid-card" onclick="openModal('ì´ê±° ì£¼ì„¸ìš”','æˆ‘è¦é€™å€‹ (ä¼Šå‹¾ æœ±ã„™ã„Ÿå‘¦)')"><span class="grid-icon">ğŸ‘‰</span><div class="grid-title">æˆ‘è¦é€™å€‹</div></div>
                <div class="grid-card" onclick="openModal('í™”ì¥ì‹¤','æ´—æ‰‹é–“åœ¨å“ªï¼Ÿ')"><span class="grid-icon">ğŸš»</span><div class="grid-title">æ´—æ‰‹é–“</div></div>
                <div class="grid-card" onclick="openModal('ê¹ì•„ì£¼ì„¸ìš”','ç®—ä¾¿å®œä¸€é»')"><span class="grid-icon">ğŸ’¸</span><div class="grid-title">ä¾¿å®œé»</div></div>
                <div class="grid-card" onclick="openModal('ë´‰íˆ¬ ì£¼ì„¸ìš”','è«‹çµ¦æˆ‘è¢‹å­')"><span class="grid-icon">ğŸ›ï¸</span><div class="grid-title">è¢‹å­</div></div>
            </div>

            <div class="section-header">å¸¸ç”¨åœ°åœ–</div>
            <div class="ios-card">
                <a href="https://m.map.naver.com/" target="_blank" class="ios-list-item">
                    <div class="item-left">
                        <div class="item-title"><i class="fa-solid fa-map" style="color:#03C75A;"></i> Naver Map</div>
                        <div class="item-desc">åœ¨éŸ“åœ‹è«‹ç”¨é€™å€‹å°èˆª</div>
                    </div>
                    <div class="item-right">
                        <i class="fa-solid fa-chevron-right" style="color:#ccc; font-size:14px;"></i>
                    </div>
                </a>
            </div>
        </div>

    </main>

    <nav>
        <button class="nav-btn active" onclick="switchView('plan', this)">
            <i class="fa-solid fa-calendar-days"></i>
            <span>è¡Œç¨‹</span>
        </button>
        <button class="nav-btn" onclick="switchView('calc', this)">
            <i class="fa-solid fa-calculator"></i>
            <span>è¨ˆç®—</span>
        </button>
        <button class="nav-btn" onclick="switchView('guide', this)">
            <i class="fa-solid fa-book-open"></i>
            <span>æ”»ç•¥</span>
        </button>
    </nav>

    <div id="modal" class="modal-overlay" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div id="m-big" style="font-size:36px; font-weight:800; margin-bottom:12px; color:var(--text-main); line-height:1.2;"></div>
            <div id="m-sub" style="font-size:16px; color:var(--text-sub); font-weight:500;"></div>
            <button class="modal-btn" onclick="closeModal()">é—œé–‰</button>
        </div>
    </div>
</div>

<script>
    // ================= DATA (2026 1æœˆç‰¹åˆ¥ç‰ˆ) =================
    const APP_DATA = {
        rate: 0.0235, // å†¬å­£é è¨­åŒ¯ç‡
        itinerary: [
            { 
                d: 1, date: "1/25 (æ—¥)", title: "æŠµé” & æ˜æ´æˆ°å€",
                items: [
                    { time:"13:00", title:"L7 é£¯åº— Check-in", desc:"å¤§å»³æ©Ÿå™¨æ›éŒ¢ / é ˜WOWPASS / å¯„æ”¾è¡Œæ", map:"L7 ëª…ë™", addr:"ì„œìš¸ ì¤‘êµ¬ í‡´ê³„ë¡œ 137" },
                    { 
                        type:"meal", title:"æ˜æ´åˆé¤", 
                        opts:[
                            {n:"æ˜æ´é¤ƒå­", k:"ëª…ë™êµì", t:"wait", tip:"é€±æ—¥äººå¤šï¼Œå»ºè­°æœ¬åº—åˆ†åº—å“ªé‚Šå°‘äººæ’å“ªé‚Š", addr:"ì„œìš¸ ì¤‘êµ¬ ëª…ë™10ê¸¸ 29"},
                            {n:"ç¥ä»™é›ªæ¿ƒæ¹¯", k:"ì‹ ì„ ì„¤ë†íƒ•", t:"wait", tip:"å†¬å¤©å–ç†±æ¹¯æœ€èˆ’æœ", addr:"ì„œìš¸ ì¤‘êµ¬ ëª…ë™ê¸¸ 56-1"},
                            {n:"è’è¬¬çš„ç”Ÿè‚‰", k:"ì—‰í„°ë¦¬ìƒê³ ê¸°", t:"walk", tip:"CPå€¼é«˜çƒ¤è‚‰", addr:"ì„œìš¸ ì¤‘êµ¬ ëª…ë™4ê¸¸ 23"}
                        ]
                    },
                    { 
                        title:"æ¨‚å¤©ç™¾è²¨ & å…ç¨…åº—", desc:"æ³¨æ„ï¼šé€±æ—¥å»¶é•·ç‡Ÿæ¥­è‡³ 20:30ã€‚å…ˆå»9-12Få…ç¨…åº—è¾¦é‡‘å¡ã€‚", map:"ë¡¯ë°ë°±í™”ì  ë³¸ì ", addr:"ì„œìš¸ ì¤‘êµ¬ ë‚¨ëŒ€ë¬¸ë¡œ 81",
                        brands: ["Gentle Monster", "Tamburins (B1)", "Matin Kim", "Blue Elephant"]
                    },
                    { 
                        title:"æ˜æ´å¤§è¡— æƒè²¨", desc:"æ°£æº«é è¨ˆ-5åº¦ï¼Œå¤ªå†·å¯èº²é€² Olive Young æ——è‰¦åº—ã€‚", map:"ëª…ë™ê±°ë¦¬", addr:"ì„œìš¸ ì¤‘êµ¬ ëª…ë™8ë‚˜ê¸¸",
                        brands: ["emis (å¸½)", "Musinsa Standard", "Olive Young æ——è‰¦åº—", "HBAFæä»æœ"]
                    },
                    { 
                        time:"19:00", type:"meal", title:"æ™šé¤ï¼šéŸ“å¼çƒ¤è‚‰", 
                        opts:[
                            {n:"ç‹å¦ƒå®¶", k:"ì™•ë¹„ì§‘", t:"res", addr:"ì„œìš¸ ì¤‘êµ¬ ëª…ë™8ê°€ê¸¸ 26"},
                            {n:"é»ƒé‡‘ç‰§å ´", k:"í™©ê¸ˆëª©ì¥", t:"res", addr:"ì„œìš¸ ì¤‘êµ¬ ëª…ë™8ë‚˜ê¸¸ 6"},
                            {n:"è‚‰çµ±ç¸½", k:"ìœ¡í†µë ¹", t:"wait", addr:"ì„œìš¸ ì¤‘êµ¬ ëª…ë™8ë‚˜ê¸¸ 37-2"}
                        ]
                    }
                ]
            },
            { 
                d: 2, date: "1/26 (ä¸€)", title: "å¤å®® & æ±å¤§é–€æ‰¹ç™¼",
                items: [
                    { time:"09:30", title:"æ™¯ç¦å®® (é€±ä¸€æœ‰é–‹)", desc:"é¸é€±ä¸€ä¾†æ˜¯å°çš„(é€±äºŒä¼‘)ã€‚å¼·çƒˆå»ºè­°ç©¿ç™¼ç†±è¡£åœ¨éŸ“æœå…§ï¼", map:"ê²½ë³µê¶", addr:"ì„œìš¸ ì¢…ë¡œêµ¬ ì‚¬ì§ë¡œ 161" },
                    { 
                        time:"12:00", type:"meal", title:"è¥¿æ‘åˆé¤", 
                        opts:[
                            {n:"åœŸä¿—æ‘è”˜é›æ¹¯", k:"í† ì†ì´Œ", t:"walk", tip:"å†¬å¤©å¿…åƒï¼Œèº«é«”æœƒæš–èµ·ä¾†", addr:"ì„œìš¸ ì¢…ë¡œêµ¬ ìí•˜ë¬¸ë¡œ5ê¸¸ 5"},
                            {n:"é€šä»å¸‚å ´", k:"í†µì¸ì‹œì¥", t:"walk", tip:"éŠ…éŒ¢ä¾¿ç•¶æœ‰è¶£ä½†å†¬å¤©èœæ˜“å†·", addr:"ì„œìš¸ ì¢…ë¡œêµ¬ ìí•˜ë¬¸ë¡œ15ê¸¸ 18"}
                        ]
                    },
                    { 
                        time:"14:30", title:"å—å¤§é–€å¸‚å ´ (ç«¥è£)", desc:"Porki, Burdeng éƒ½åœ¨ Mama ç«¥è£æ£Ÿã€‚å‹™å¿… 16:30 å‰è²·å®Œã€‚", map:"ë‚¨ëŒ€ë¬¸ì‹œì¥ ì•„ë™ë³µê±°ë¦¬", addr:"ì„œìš¸ ì¤‘êµ¬ ë‚¨ëŒ€ë¬¸ì‹œì¥8ê¸¸ 7",
                        brands: ["Burdeng", "Mama", "Porky", "Crayon"]
                    },
                    { 
                        time:"20:00", title:"æ±å¤§é–€æ‰¹ç™¼å¤œéŠ", desc:"é€±ä¸€æ™šä¸Šè²¨æœ€é½Šï¼apM Place -> apM Luxe -> nuZZonã€‚", map:"apM PLACE", addr:"ì„œìš¸ ì¤‘êµ¬ ì„ì§€ë¡œ 276",
                        brands: ["apM PLACE (é£¾å“)", "nyu.nyu (3è¬èµ·é€€ç¨…)", "MIMILINE"]
                    },
                    { 
                        type:"meal", title:"æ±å¤§é–€å®µå¤œ", 
                        opts:[{n:"é™³ç‰è¯ä¸€éš»é›", k:"ì§„ì˜¥í™”í• ë§¤ì›ì¡°ë‹­í•œë§ˆë¦¬", t:"wait", addr:"ì„œìš¸ ì¢…ë¡œêµ¬ ì¢…ë¡œ40ê°€ê¸¸ 18"}, {n:"æ©‹æ‘ç‚¸é›", k:"êµì´Œì¹˜í‚¨", t:"walk", addr:"ì„œìš¸ ì¢…ë¡œêµ¬ ì¢…ë¡œ 294"}]
                    }
                ]
            },
            { 
                d: 3, date: "1/27 (äºŒ)", title: "è¿‘éƒŠ & å—å±±å¡”",
                items: [
                    { time:"07:30", title:"ä¸€æ—¥éŠé›†åˆ", desc:"é€™å¤©æœƒéå¸¸å†·(éƒŠå€æ›´å†·)ï¼Œæš–æš–åŒ…è¦åœ¨è‚šå­/èƒŒå¾Œå„è²¼ä¸€å€‹ã€‚", addr:"é›†åˆåœ°é»ä¾é è¨‚ç‚ºæº–" },
                    { time:"10:00", title:"å—æ€¡å³¶/ç¾Šé§/æ»‘é›ª", desc:"æˆ´æ‰‹å¥—ã€æ¯›å¸½ã€‚æ‰‹æ©Ÿå¤ªå†·æœƒé—œæ©Ÿï¼Œæš–æš–åŒ…è¦è²¼æ‰‹æ©ŸèƒŒé¢ã€‚", map:"ë‚¨ì´ì„¬" },
                    { time:"18:30", title:"è¿”å›æ˜æ´", desc:"è§£æ•£å¾Œå›é£¯åº—æ”¾æ±è¥¿ï¼Œç¨å¾®ä¼‘æ¯ã€‚" },
                    { 
                        type:"choice", title:"å¤œæ™šäºŒé¸ä¸€", desc:"çœ‹ç´¯ä¸ç´¯æ±ºå®š",
                        choices: [
                            {n:"A æ–¹æ¡ˆ", desc:"å—å±±å¡”å¤œæ™¯ (å¤ªå†·å°±åˆ¥æ’çºœè»Šï¼Œæ”¹æ­01è™Ÿå…¬è»Šä¸Šå±±)", target:"Nì„œìš¸íƒ€ì›Œ"},
                            {n:"B æ–¹æ¡ˆ", desc:"æ˜æ´æŒ‰æ‘© + BHC ç‚¸é›", target:"BHCì¹˜í‚¨ ëª…ë™ë³¸ì "}
                        ]
                    },
                    { title:"å—å±±é¦–çˆ¾å¡”", desc:"è‹¥é¸Aï¼šå¤œæ™¯æ¥µç¾ä½†é¢¨å¤§ã€‚åœ°å€çµ¦è¨ˆç¨‹è»Šå¸æ©Ÿè¼‰å»çºœè»Šç«™ã€‚", map:"ë‚¨ì‚°ì¼€ì´ë¸”ì¹´", addr:"ì„œìš¸ ì¤‘êµ¬ ì†ŒíŒŒë¡œ 83" }
                ]
            },
            { 
                d: 4, date: "1/28 (ä¸‰)", title: "ç‹é·—äº­ & è–æ°´æ´",
                items: [
                    { 
                        time:"10:30", title:"London Bagel Museum", desc:"å…ˆå»åº—é–€å£ç”¨å¹³æ¿å€™ä½(CatchTable)ï¼Œç„¶å¾Œå»é€›åˆ¥çš„ã€‚", map:"ëŸ°ë˜ë² ì´ê¸€ë®¤ì§€ì—„ ë„ì‚°ì ", addr:"ì„œìš¸ ê°•ë‚¨êµ¬ ì–¸ì£¼ë¡œ168ê¸¸ 33"
                    },
                    { 
                        time:"11:00", title:"ç‹é·—äº­ æ½®ç‰Œ", desc:"Haus Dosan (GMå¢¨é¡/Nudakeè›‹ç³•) 11é»é–‹ã€‚", map:"í•˜ìš°ìŠ¤ ë„ì‚°", addr:"ì„œìš¸ ê°•ë‚¨êµ¬ ì••êµ¬ì •ë¡œ46ê¸¸ 50",
                        brands: ["StÃ¼ssy", "Supreme", "Wiggle Wiggle"]
                    },
                    { 
                        time:"14:30", title:"è–æ°´æ´ (Seongsu)", desc:"å¹³æ—¥ä¸‹åˆäººæ½®è¼ƒå°‘ã€‚å¿…å» Dior æ¦‚å¿µåº—æ‹ç…§ã€‚", map:"ì„±ìˆ˜ë™ ì¹´í˜ê±°ë¦¬", addr:"ì„œìš¸ ì„±ë™êµ¬ ì—°ë¬´ì¥5ê¸¸ 7",
                        brands: ["Dior è–æ°´", "TAMBURINS", "ADER Error", "Stand Oil", "Point of View"]
                    },
                    { 
                        time:"17:30", type:"meal", title:"è–æ°´æ´æ™šé¤", 
                        opts:[
                            {n:"ç¥–å‚³ä¸‰ä»£é¦¬éˆ´è–¯æ¹¯", k:"ì†Œë¬¸ë‚œì„±ìˆ˜ê°ìíƒ•", t:"wait", tip:"å†¬å¤©æ’éšŠå¾ˆå†·ï¼Œå»ºè­°é¿é–‹ç”¨é¤å°–å³°", addr:"ì„œìš¸ ì„±ë™êµ¬ ì—°ë¬´ì¥ê¸¸ 45"},
                            {n:"Daelim Guksu", k:"ëŒ€ë¦¼êµ­ìˆ˜", t:"walk", tip:"æº«éºµ+çƒ¤ä¸²", addr:"ì„œìš¸ ì„±ë™êµ¬ ì—°ë¬´ì¥7ê°€ê¸¸ 5-1"}
                        ]
                    }
                ]
            },
            { 
                d: 5, date: "1/29 (å››)", title: "ç¾ä»£ç™¾è²¨ & æ±çŸ£å³¶",
                items: [
                    { time:"10:30", title:"Zoolung Zoolung", desc:"å®¤å…§å‹•ç‰©åœ’ï¼Œé€™å¤©å¦‚æœå¤ªå†·å‰›å¥½èº²é€²ä¾†ã€‚", map:"ì£¼ë ì£¼ë  ì˜ë“±í¬", addr:"ì„œìš¸ ì˜ë“±í¬êµ¬ ì˜ì¤‘ë¡œ 15 4F" },
                    { 
                        time:"13:30", title:"The Hyundai Seoul", desc:"ç¾ä»£ç™¾è²¨ã€‚å¹³æ—¥(é€±å››)äººæ½®å°šå¯ã€‚B2 æ½®ç‰Œï¼Œ5F æ‹ç…§ã€‚", map:"ë”í˜„ëŒ€ ì„œìš¸", addr:"ì„œìš¸ ì˜ë“±í¬êµ¬ ì—¬ì˜ëŒ€ë¡œ 108",
                        brands: ["Matin Kim", "Marithe", "Arket", "Casetify", "Nice Weather"]
                    },
                    { 
                        type:"meal", title:"ç™¾è²¨å…§ç¾é£Ÿ", 
                        opts:[{n:"Camel Coffee", k:"", t:"app", addr:"B1"}, {n:"Five Guys", k:"", t:"app", addr:"B1"}]
                    },
                    { time:"19:00", title:"æ±çŸ£å³¶æ¼¢æ±Ÿå…¬åœ’", desc:"âš ï¸ å†¬å¤©æ±Ÿé‚Šé¢¨æ¥µå¤§ï¼è‹¥å¤ªå†·å»ºè­°æ”¹å» IFC Mall é€›è¡—ï¼Œä¸è¦ç¡¬å¹é¢¨ã€‚", map:"ì—¬ì˜ë„í•œê°•ê³µì›", addr:"ì„œìš¸ ì˜ë“±í¬êµ¬ ì—¬ì˜ë™ë¡œ 330" }
                ]
            },
            { 
                d: 6, date: "1/30 (äº”)", title: "æœ€å¾Œè¡åˆº & è¿”å°",
                items: [
                    { time:"09:00", title:"Check-out", desc:"è¡Œæå¯„æ”¾é£¯åº—ï¼ŒæŠŠæ¡æœ€å¾Œå¹¾å°æ™‚ã€‚" },
                    { 
                        title:"å»£è—å¸‚å ´", desc:"ç¶ è±†ç…é¤…ã€ç”Ÿæ‹Œç‰›è‚‰ã€‚é€±äº”æ—©ä¸Šäººæ½®é–‹å§‹è®Šå¤šã€‚", map:"ê´‘ì¥ì‹œì¥", addr:"ì„œìš¸ ì¢…ë¡œêµ¬ ì°½ê²½ê¶ë¡œ 88",
                        brands: ["å¯Œæ‘ç”Ÿæ‹Œç‰›è‚‰", "é †ç†™å®¶ç¶ è±†ç…é¤…", "æ£‰è¢«(çœŸç©ºåŒ…è£)"]
                    },
                    { title:"æ¨‚å¤©è¶…å¸‚ (é¦–çˆ¾ç«™)", desc:"æœ€å¾Œé›¶é£Ÿæ¡è³¼ï¼Œè²·å®Œç›´æ¥æ­æ©Ÿå ´å¿«ç·šæˆ–å·´å£«ã€‚", map:"ë¡¯ë°ë§ˆíŠ¸ ì„œìš¸ì—­ì ", addr:"ì„œìš¸ ì¤‘êµ¬ í•œê°•ëŒ€ë¡œ 405" },
                    { time:"12:30", title:"å‰å¾€æ©Ÿå ´", desc:"é€±äº”ä¸‹åˆæ˜“å¡è»Šï¼Œå»ºè­°ææ—©å‡ºç™¼ã€‚æ©Ÿå ´é ˜å…ç¨…å“äººå¤šã€‚", map:"ì¸ì²œêµ­ì œê³µí•­" }
                ]
            }
        ]
    };

    // ================= CONTROLLER =================
    
    window.onload = function() {
        renderDaySlider();
        renderDayContent(0);
        updateWeather();
        updateRate();
    };

    function switchView(viewId, btn) {
        ['plan', 'calc', 'guide'].forEach(id => {
            document.getElementById('view-' + id).classList.add('hidden');
        });
        document.getElementById('view-' + viewId).classList.remove('hidden');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        window.scrollTo({top: 0, behavior: 'smooth'});
    }

    // --- Render Slider ---
    function renderDaySlider() {
        const slider = document.getElementById('day-slider');
        slider.innerHTML = APP_DATA.itinerary.map((d, i) => `
            <div class="day-chip ${i === 0 ? 'active' : ''}" onclick="selectDay(${i}, this)">
                <span class="day-chip-num">Day ${d.d}</span>
                <span class="day-chip-date">${d.date.split(' ')[0]}</span>
            </div>
        `).join('');
    }

    function selectDay(index, el) {
        document.querySelectorAll('.day-chip').forEach(c => c.classList.remove('active'));
        el.classList.add('active');
        el.scrollIntoView({behavior: 'smooth', block: 'nearest', inline: 'center'});
        
        const content = document.getElementById('day-content');
        content.style.opacity = '0';
        content.style.transform = 'translateY(5px)';
        content.style.transition = 'all 0.2s';
        
        setTimeout(() => {
            renderDayContent(index);
            content.style.opacity = '1';
            content.style.transform = 'translateY(0)';
        }, 150);
    }

    // --- Render Content (å·²å„ªåŒ–åœ°å€èˆ‡è¤‡è£½åŠŸèƒ½) ---
    function renderDayContent(index) {
        const data = APP_DATA.itinerary[index];
        const container = document.getElementById('day-content');
        
        let html = `
            <div class="ios-card" style="padding:20px; text-align:center; background:linear-gradient(to bottom, #fff, #fafafa);">
                <div style="font-size:20px; font-weight:800; color:var(--text-main);">${data.title}</div>
                <div style="font-size:14px; color:var(--text-sub); margin-top:4px;">${data.date}</div>
            </div>
        `;

        data.items.forEach(ev => {
            // è¤‡è£½æŒ‰éˆ•ç”Ÿæˆå™¨
            const copyBtn = (addr) => addr ? `
                <div class="addr-btn" onclick="copyToClip('${addr}', event)">
                    <i class="fa-regular fa-copy"></i> è¤‡è£½åœ°å€
                </div>` : '';

            // 1. é¤å»³
            if (ev.type === 'meal') {
                html += `
                <div class="ios-card">
                    <div style="padding:12px 16px; background:#f9f9f9; border-bottom:0.5px solid rgba(0,0,0,0.05); display:flex; justify-content:space-between; align-items:center;">
                        <div style="font-weight:700; color:var(--text-main); display:flex; align-items:center; gap:6px;">
                            <i class="fa-solid fa-utensils" style="color:#D4A373;"></i> ${ev.title}
                        </div>
                        ${ev.time ? `<span class="time-badge">${ev.time}</span>` : ''}
                    </div>
                    <div>
                        ${ev.opts.map(opt => {
                            let tagClass = opt.t === 'app' ? 'tag-app' : (opt.t === 'res' ? 'tag-res' : 'tag-wait');
                            let tagText = opt.t === 'app' ? 'App' : (opt.t === 'res' ? 'é ç´„' : 'æ’éšŠ');
                            let link = opt.k ? `https://m.map.naver.com/search2/search.naver?query=${encodeURIComponent(opt.k)}` : '#';
                            return `
                            <div class="ios-list-item">
                                <a href="${link}" target="_blank" class="item-left" style="text-decoration:none; color:inherit;">
                                    <div class="item-title">${opt.n}</div>
                                    <div class="item-desc">${opt.tip || ''}</div>
                                </a>
                                <div class="item-right">
                                    <span class="tag ${tagClass}">${tagText}</span>
                                    ${copyBtn(opt.addr)}
                                </div>
                            </div>`;
                        }).join('')}
                    </div>
                </div>`;
            } 
            // 2. äºŒé¸ä¸€ (æŠ‰æ“‡)
            else if (ev.type === 'choice') {
                html += `
                <div class="ios-card" style="border: 2px dashed var(--border); background:#FAFAFA; padding:16px;">
                    <div style="text-align:center; font-weight:700; color:var(--primary-dark); margin-bottom:12px;">${ev.title}</div>
                    ${ev.choices.map((c, idx) => `
                    <a href="https://m.map.naver.com/search2/search.naver?query=${encodeURIComponent(c.target)}" target="_blank" class="ios-list-item" style="border-radius:12px; margin-bottom:8px; border:1px solid #eee;">
                        <div class="item-left">
                            <span style="font-size:10px; font-weight:800; background:${idx===0?'var(--text-main)':'var(--primary)'}; color:white; padding:2px 6px; border-radius:4px; margin-right:6px;">${c.n}</span>
                            <span style="font-weight:700;">${c.desc}</span>
                        </div>
                        <div class="item-right">
                            <i class="fa-solid fa-chevron-right" style="font-size:12px; color:#ccc;"></i>
                        </div>
                    </a>`).join('')}
                </div>`;
            } 
            // 3. ä¸€èˆ¬è¡Œç¨‹
            else {
                let link = ev.map ? `https://m.map.naver.com/search2/search.naver?query=${encodeURIComponent(ev.map)}` : null;
                html += `
                <div class="ios-card">
                    <div class="ios-list-item" style="cursor:default;">
                        <div class="item-left">
                            <div class="item-title" onclick="${link ? `window.open('${link}')` : ''}">${ev.title}</div>
                            <div class="item-desc" style="margin-top:2px;">${ev.desc}</div>
                            ${ev.brands ? `
                            <div class="brand-list">
                                ${ev.brands.map(b => {
                                    let isMust = b.includes('Dior') || b.includes('GM') || b.includes('Olive');
                                    return `<span class="brand-tag ${isMust?'tag-must':''}">${b}</span>`
                                }).join('')}
                            </div>` : ''}
                        </div>
                        <div class="item-right">
                            ${ev.time ? `<span class="time-badge">${ev.time}</span>` : ''}
                            ${copyBtn(ev.addr)}
                        </div>
                    </div>
                </div>`;
            }
        });
        container.innerHTML = html;
    }

    // --- Weather ---
    async function updateWeather() {
        const tempEl = document.getElementById('wc-temp');
        const descEl = document.getElementById('wc-desc');
        const iconEl = document.getElementById('wc-icon');
        
        descEl.innerText = "æ›´æ–°ä¸­...";
        
        try {
            const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=37.5665&longitude=126.9780&current=temperature_2m,weather_code&timezone=Asia%2FSeoul');
            if(!res.ok) throw new Error();
            const d = await res.json();
            
            const temp = Math.round(d.current.temperature_2m);
            const code = d.current.weather_code;
            
            tempEl.innerText = `${temp}Â°C`;
            
            let iconClass = 'fa-sun';
            let descText = 'æ™´æœ—';
            
            if(code > 2) { iconClass = 'fa-cloud'; descText = 'å¤šé›²'; }
            if(code > 45) { iconClass = 'fa-smog'; descText = 'æœ‰éœ§'; }
            if(code >= 51) { iconClass = 'fa-cloud-rain'; descText = 'æœ‰é›¨'; }
            if(code >= 71) { iconClass = 'fa-snowflake'; descText = 'ä¸‹é›ª'; }
            
            // 1æœˆå†¬å¤©ç‰¹åˆ¥è­¦ç¤º
            if(temp < 0) {
                descText += " (æ¥µå†·)";
                iconClass = 'fa-snowflake';
            }
            
            iconEl.className = `fa-solid ${iconClass}`;
            descEl.innerText = `é¦–çˆ¾ç›®å‰ ${descText}`;
            
        } catch(e) {
            tempEl.innerText = "-5Â°"; // å†¬å¤©é è¨­å€¼
            descEl.innerText = "é è¨­: å¯’å†·";
            iconEl.className = 'fa-solid fa-snowflake';
        }
    }

    // --- Calc & Tools ---
    function calculateAll() {
        const inputEl = document.getElementById('calc-input');
        let raw = inputEl.value.replace(/[^0-9.]/g, '');
        let val = parseFloat(raw);
        if(isNaN(val)) {
            document.getElementById('res-twd').innerText = '0';
            document.getElementById('res-tax').innerText = '0';
            return;
        }
        document.getElementById('res-twd').innerText = Math.round(val * APP_DATA.rate).toLocaleString();
        
        let r = 0;
        if (val >= 30000 && val < 50000) r = 1500;
        else if (val >= 50000 && val < 75000) r = 3500;
        else if (val >= 75000 && val < 100000) r = 5000;
        else if (val >= 100000) r = Math.floor(val * 0.06);
        document.getElementById('res-tax').innerText = 'â‚© ' + r.toLocaleString();
    }

    function resetCalc() {
        document.getElementById('calc-input').value = '';
        calculateAll();
    }

    function updateRate() {
        fetch('https://api.exchangerate-api.com/v4/latest/KRW')
            .then(r=>r.json()).then(d=>{
                if(d.rates.TWD) {
                    APP_DATA.rate = d.rates.TWD;
                    document.getElementById('rate-display').innerText = APP_DATA.rate.toFixed(4);
                }
            }).catch(()=>{});
    }

    // æ–°å¢ï¼šè¤‡è£½åœ°å€åŠŸèƒ½
    function copyToClip(text, e) {
        if(e) e.stopPropagation(); // é¿å…è§¸ç™¼çˆ¶å±¤é»æ“Š
        if (!text) return;
        
        navigator.clipboard.writeText(text).then(() => {
            const t = document.getElementById('toast');
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 2000);
        }).catch(err => {
            // iOS æœ‰æ™‚æœƒæ“‹ clipboard APIï¼Œé€™è£¡åšå€‹ç°¡å–® fallback
            const input = document.createElement('textarea');
            input.value = text;
            document.body.appendChild(input);
            input.select();
            document.execCommand('copy');
            document.body.removeChild(input);
            
            const t = document.getElementById('toast');
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 2000);
        });
    }

    function openModal(big, sub) {
        document.getElementById('m-big').innerText = big;
        document.getElementById('m-sub').innerText = sub;
        const m = document.getElementById('modal');
        m.style.display='flex';
        requestAnimationFrame(()=>m.classList.add('show'));
    }
    function closeModal() {
        const m = document.getElementById('modal');
        m.classList.remove('show');
        setTimeout(()=>m.style.display='none', 300);
    }
</script>
</body>
</html>

