<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#FDFBF7">
    <meta name="format-detection" content="telephone=no">
    <title>é¦–çˆ¾ 2026</title>
    
    <!-- åœ–ç¤ºåº« -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload="this.media='all'">
    <!-- åœ“é«”å­—å‹ -->
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;500;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* --- æ ¸å¿ƒè¨­è¨ˆç³»çµ± (å¥¶èŒ¶è‰²ç³» + åŸç”Ÿæ„Ÿ) --- */
        :root {
            --bg: #F2F1F6; /* iOS é è¨­ç°åº•ï¼Œæ¯”ç´”ç™½æ›´æœ‰å±¤æ¬¡ */
            --surface: #FFFFFF;
            --primary: #C8A47E;
            --primary-dark: #A68665;
            --text-main: #1C1C1E;
            --text-sub: #8E8E93;
            --border: #E5E5EA;
            
            --accent-green: #34C759; 
            --accent-red: #FF3B30;
            --accent-blue: #007AFF;
            
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            
            --safe-top: env(safe-area-inset-top, 20px);
            --safe-bottom: env(safe-area-inset-bottom, 20px);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            margin: 0; padding: 0;
            background-color: var(--bg);
            color: var(--text-main);
            /* ä½¿ç”¨ç³»çµ±å­—é«”å„ªå…ˆï¼Œç¢ºä¿åŸç”Ÿæ„Ÿ */
            font-family: -apple-system, BlinkMacSystemFont, "M PLUS Rounded 1c", "Segoe UI", Roboto, sans-serif;
            font-size: 16px; /* 16px æ˜¯ App æ¨™æº–å­—è™Ÿ */
            line-height: 1.5;
            overscroll-behavior-y: none;
            user-select: none; /* é—œéµï¼šç¦æ­¢é¸å–æ–‡å­—ï¼Œåƒ App */
            -webkit-user-select: none;
        }

        /* --- Header (æ¯›ç»ç’ƒ) --- */
        header {
            position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
            background: rgba(242, 241, 246, 0.85); /* åŠé€æ˜èƒŒæ™¯ */
            backdrop-filter: blur(20px); /* å¼·åŠ›æ¯›ç»ç’ƒ */
            -webkit-backdrop-filter: blur(20px);
            padding: calc(10px + var(--safe-top)) 16px 10px 16px;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 0.5px solid rgba(0,0,0,0.1);
        }
        h1 { margin: 0; font-size: 22px; font-weight: 800; color: var(--text-main); letter-spacing: 0.5px; }
        .weather-pill {
            font-size: 13px; font-weight: 600; color: var(--text-main);
            background: rgba(255,255,255,0.6); padding: 6px 12px; border-radius: 20px;
            display: flex; align-items: center; gap: 6px;
        }

        /* --- Main Content --- */
        main {
            padding: calc(60px + var(--safe-top)) 16px calc(90px + var(--safe-bottom)) 16px;
            min-height: 100vh;
        }

        /* --- åŸç”Ÿæ„Ÿå¡ç‰‡ (Inset Grouped) --- */
        .ios-card {
            background: var(--surface);
            border-radius: 16px; /* iOS æ¨™æº–åœ“è§’ */
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .ios-list-item {
            padding: 16px;
            display: flex; align-items: center; justify-content: space-between;
            background: var(--surface);
            border-bottom: 0.5px solid rgba(0,0,0,0.1); /* æ¥µç´°åˆ†éš”ç·š */
            transition: background 0.2s;
            text-decoration: none; color: inherit;
            cursor: pointer;
        }
        .ios-list-item:last-child { border-bottom: none; }
        .ios-list-item:active { background: #E5E5EA; } /* é»æ“Šå›é¥‹ */

        /* å…§å®¹ä½ˆå±€ */
        .item-content { flex: 1; margin-right: 12px; }
        .item-title { font-weight: 600; font-size: 16px; margin-bottom: 4px; display: flex; align-items: center; gap: 6px; }
        .item-desc { font-size: 13px; color: var(--text-sub); line-height: 1.4; }
        .item-meta { display: flex; align-items: center; gap: 8px; flex-shrink: 0; }

        /* --- Day Slider (è† å›Šåˆ‡æ›) --- */
        .day-slider {
            display: flex; overflow-x: auto; gap: 8px; padding: 4px 4px 16px 4px;
            margin: 0 -16px 0 -16px; padding-left: 16px; padding-right: 16px;
            scrollbar-width: none; scroll-behavior: smooth;
        }
        .day-slider::-webkit-scrollbar { display: none; }
        
        .day-chip {
            flex: 0 0 auto; min-width: 60px;
            background: var(--surface);
            border-radius: 12px; padding: 8px 10px;
            text-align: center; cursor: pointer;
            transition: transform 0.1s;
            color: var(--text-sub);
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        .day-chip:active { transform: scale(0.95); }
        .day-chip.active {
            background: var(--text-main); color: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .day-chip-num { font-size: 11px; margin-bottom: 2px; opacity: 0.8; font-weight: 600; }
        .day-chip-date { font-size: 15px; font-weight: 700; }

        /* --- Section Title --- */
        .section-title {
            font-size: 13px; font-weight: 600; color: var(--text-sub);
            margin: 24px 0 8px 4px; text-transform: uppercase; letter-spacing: 0.5px;
        }

        /* --- Tags & Badges --- */
        .tag { font-size: 11px; padding: 4px 8px; border-radius: 6px; font-weight: 700; }
        .tag-gray { background: #F2F2F7; color: #8E8E93; }
        .tag-green { background: #E4F9E9; color: #34C759; }
        .tag-red { background: #FFEBEA; color: #FF3B30; }
        .tag-blue { background: #E7F3FF; color: #007AFF; }

        /* --- Buttons --- */
        .btn-icon {
            width: 32px; height: 32px; border-radius: 50%;
            background: #F2F2F7; color: var(--accent-green);
            display: flex; align-items: center; justify-content: center;
            font-size: 14px; transition: transform 0.1s;
        }
        .btn-icon:active { transform: scale(0.9); }

        /* --- Calc --- */
        .calc-display {
            background: var(--surface); border-radius: 16px; padding: 24px;
            text-align: right; margin-bottom: 16px; box-shadow: var(--shadow-sm);
        }
        .calc-input {
            width: 100%; border: none; background: transparent; text-align: right;
            font-size: 48px; font-weight: 300; color: var(--text-main); outline: none;
            font-family: -apple-system, monospace; margin: 8px 0;
        }
        .calc-label { font-size: 13px; color: var(--text-sub); font-weight: 600; }
        .result-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 12px 0; border-top: 0.5px solid rgba(0,0,0,0.1);
        }
        .result-val { font-size: 20px; font-weight: 600; font-family: monospace; }

        /* --- Grid Layout (Korean Cards) --- */
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .grid-card {
            background: var(--surface); border-radius: 16px; padding: 20px;
            text-align: center; box-shadow: var(--shadow-sm); transition: transform 0.1s;
        }
        .grid-card:active { transform: scale(0.96); background: #F9F9F9; }
        .grid-icon { font-size: 32px; margin-bottom: 8px; display: block; }
        .grid-title { font-size: 16px; font-weight: 700; color: var(--text-main); }
        .grid-sub { font-size: 12px; color: var(--text-sub); margin-top: 2px; }

        /* --- Bottom Nav (TabBar) --- */
        nav {
            position: fixed; bottom: 0; left: 0; right: 0; z-index: 1000;
            background: rgba(255,255,255,0.85); backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 0.5px solid rgba(0,0,0,0.15);
            padding-bottom: var(--safe-bottom);
            height: calc(55px + var(--safe-bottom));
            display: flex; justify-content: space-around; align-items: center;
        }
        .nav-btn {
            border: none; background: none; flex: 1; height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            gap: 3px; color: #999; transition: color 0.2s;
        }
        .nav-btn.active { color: var(--primary); }
        .nav-btn i { font-size: 22px; margin-bottom: 1px; }
        .nav-btn span { font-size: 10px; font-weight: 600; letter-spacing: 0.2px; }

        /* --- Utils --- */
        .hidden { display: none !important; }
        
        /* Modal (Action Sheet Style) */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.4); backdrop-filter: blur(4px);
            z-index: 2000; display: none; align-items: flex-end; justify-content: center;
            padding-bottom: var(--safe-bottom);
        }
        .modal-overlay.show { opacity: 1; }
        .modal-content {
            background: var(--surface); width: 95%; border-radius: 20px 20px 20px 20px;
            padding: 30px 20px; text-align: center; margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
        @keyframes slideUp { from {transform: translateY(100%);} to {transform: translateY(0);} }
        .modal-big { font-size: 36px; font-weight: 800; margin-bottom: 8px; color: var(--text-main); }
        .modal-btn {
            background: var(--text-main); color: white; border: none; padding: 14px;
            width: 100%; border-radius: 14px; font-size: 16px; font-weight: 600; margin-top: 20px;
        }
        .modal-btn:active { transform: scale(0.98); opacity: 0.9; }

        /* Toast */
        #toast {
            position: fixed; top: calc(50px + var(--safe-top)); left: 50%; transform: translateX(-50%) translateY(-20px);
            background: rgba(0,0,0,0.8); color: white; padding: 8px 16px; border-radius: 20px;
            font-size: 12px; font-weight: 600; opacity: 0; transition: all 0.3s; pointer-events: none; z-index: 3000;
            backdrop-filter: blur(4px);
        }
        #toast.show { opacity: 1; transform: translateX(-50%) translateY(10px); }

    </style>
</head>
<body>

    <!-- Header -->
    <header>
        <h1>SEOUL</h1>
        <div class="weather-pill" id="weather-widget">
            <i class="fa-solid fa-spinner fa-spin"></i> è¼‰å…¥ä¸­
        </div>
    </header>
    <div id="toast"><i class="fa-solid fa-check"></i> å·²è¤‡è£½</div>

    <main>
        
        <!-- 1. è¡Œç¨‹ (Plan) -->
        <div id="view-plan">
            <div class="day-slider" id="day-slider"></div>
            <div id="day-content"></div>
        </div>

        <!-- 2. è¨ˆç®— (Calc) -->
        <div id="view-calc" class="hidden">
            <div class="section-title">åŒ¯ç‡æ›ç®— (1 KRW â‰ˆ <span id="rate-display">0.024</span>)</div>
            <div class="calc-display">
                <div class="calc-label">è¼¸å…¥éŸ“å¹£é‡‘é¡</div>
                <input type="tel" id="calc-input" class="calc-input" placeholder="0" oninput="calculateAll()">
                
                <div class="result-row">
                    <span style="color:var(--text-sub);">ç´„åˆå°å¹£</span>
                    <span class="result-val" id="res-twd">0</span>
                </div>
                <div class="result-row" style="border-top:none; padding-top:0;">
                    <span style="color:var(--text-sub);">é è¨ˆé€€ç¨…</span>
                    <span class="result-val" style="color:var(--accent-green);" id="res-tax">0</span>
                </div>
            </div>
            <div style="text-align:center; font-size:12px; color:var(--text-sub); margin-top:16px;">
                æ»¿ 30,000 éŸ“å…ƒå³å¯é€€ç¨… â€¢ ç´šè·åƒ…ä¾›åƒè€ƒ
            </div>
        </div>

        <!-- 3. æ”»ç•¥ (Guide) -->
        <div id="view-guide" class="hidden">
            <div class="section-title">ç”Ÿå­˜æºé€šå¡</div>
            <div class="grid-2">
                <div class="grid-card" onclick="modal('ì•ˆë…•í•˜ì„¸ìš”','ä½ å¥½ (å®‰å¦å“ˆã„™ã„Ÿå‘¦)')"><span class="grid-icon">ğŸ‘‹</span><div class="grid-title">ä½ å¥½</div></div>
                <div class="grid-card" onclick="modal('ê°ì‚¬í•©ë‹ˆë‹¤','è¬è¬ (åº·æ’’å“ˆå’ªæ­)')"><span class="grid-icon">ğŸ™</span><div class="grid-title">è¬è¬</div></div>
                <div class="grid-card" onclick="modal('ì´ê±° ì£¼ì„¸ìš”','æˆ‘è¦é€™å€‹ (ä¼Šå‹¾ æœ±ã„™ã„Ÿå‘¦)')"><span class="grid-icon">ğŸ‘‰</span><div class="grid-title">æˆ‘è¦é€™å€‹</div></div>
                <div class="grid-card" onclick="modal('í™”ì¥ì‹¤','æ´—æ‰‹é–“åœ¨å“ªï¼Ÿ')"><span class="grid-icon">ğŸš»</span><div class="grid-title">æ´—æ‰‹é–“</div></div>
                <div class="grid-card" onclick="modal('ê¹ì•„ì£¼ì„¸ìš”','ç®—ä¾¿å®œä¸€é»')"><span class="grid-icon">ğŸ’¸</span><div class="grid-title">ä¾¿å®œé»</div></div>
                <div class="grid-card" onclick="modal('ë¬¼ ì¢€ ì£¼ì„¸ìš”','è«‹çµ¦æˆ‘æ°´')"><span class="grid-icon">ğŸ’§</span><div class="grid-title">çµ¦æˆ‘æ°´</div></div>
            </div>

            <div class="section-title">å¯¦ç”¨é€£çµ</div>
            <div class="ios-card">
                <a href="https://m.map.naver.com/" target="_blank" class="ios-list-item">
                    <div class="item-content">
                        <div class="item-title"><i class="fa-solid fa-map" style="color:#03C75A;"></i> Naver Map</div>
                        <div class="item-desc">éŸ“åœ‹å¿…å‚™åœ°åœ–å°èˆª</div>
                    </div>
                    <i class="fa-solid fa-chevron-right" style="color:#ccc; font-size:12px;"></i>
                </a>
                <a href="https://n.weather.naver.com/" target="_blank" class="ios-list-item">
                    <div class="item-content">
                        <div class="item-title"><i class="fa-solid fa-cloud" style="color:#007AFF;"></i> Naver Weather</div>
                        <div class="item-desc">å³æ™‚å¤©æ°£èˆ‡ç©¿è¡£æŒ‡æ•¸</div>
                    </div>
                    <i class="fa-solid fa-chevron-right" style="color:#ccc; font-size:12px;"></i>
                </a>
            </div>
        </div>

    </main>

    <!-- Bottom Nav -->
    <nav>
        <button class="nav-btn active" onclick="switchView('plan', this)">
            <i class="fa-solid fa-calendar-days"></i>
            <span>è¡Œç¨‹</span>
        </button>
        <button class="nav-btn" onclick="switchView('calc', this)">
            <i class="fa-solid fa-calculator"></i>
            <span>è¨ˆç®—</span>
        </button>
        <button class="nav-btn" onclick="switchView('guide', this)">
            <i class="fa-solid fa-book-open"></i>
            <span>æ”»ç•¥</span>
        </button>
    </nav>

    <!-- Modal -->
    <div id="modal" class="modal-overlay" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div id="m-big" class="modal-big"></div>
            <div id="m-sub" style="font-size:16px; color:var(--text-sub);"></div>
            <button class="modal-btn" onclick="closeModal()">é—œé–‰</button>
        </div>
    </div>

    <script>
        // --- DATA ---
        const itinerary = [
            { 
                d: 1, date: "1/25 (æ—¥)", title: "æŠµé” & æ˜æ´",
                items: [
                    { time:"13:00", title:"L7 é£¯åº—", desc:"å¯„æ”¾è¡Œæ / å¤§å»³æ›éŒ¢ / é ˜WOWPASS", map:"L7 ëª…ë™" },
                    { 
                        type:"meal", title:"åˆé¤ä¸‰é¸ä¸€", 
                        opts:[
                            {n:"æ˜æ´é¤ƒå­", k:"ëª…ë™êµì", t:"walk", tip:"äººå¤š"},
                            {n:"ç¥ä»™é›ªæ¿ƒæ¹¯", k:"ì‹ ì„ ì„¤ë†íƒ•", t:"walk", tip:"æ’éšŠ"},
                            {n:"æ²³æ±é¤¨", k:"í•˜ë™ê´€", t:"walk", tip:"è€åº—"}
                        ]
                    },
                    { 
                        title:"å…ç¨…åº—è³¼ç‰©", desc:"æ–°ä¸–ç•Œ + æ¨‚å¤©ç¸½åº— (è¨˜å¾—å¸¶è­·ç…§)", map:"ì‹ ì„¸ê³„ë©´ì„¸ì  ëª…ë™ì ",
                        brands: ["Gentle Monster", "Tamburins", "åœ‹éš›ç²¾å“(æ©Ÿå ´æ)"]
                    },
                    { 
                        time:"18:00", title:"æ˜æ´æƒè²¨", desc:"é£¯åº—æ¨“ä¸‹å°±æ˜¯æˆ°å€", map:"ë¬´ì‹ ì‚¬ ìŠ¤íƒ ë‹¤ë“œ ëª…ë™",
                        brands: ["emis", "The North Face", "Musinsa", "NB"]
                    },
                    { 
                        time:"19:00", type:"meal", title:"æ™šé¤ï¼šéŸ“å¼çƒ¤è‚‰", 
                        opts:[
                            {n:"ç‹å¦ƒå®¶", k:"ì™•ë¹„ì§‘", t:"res"},
                            {n:"é»ƒé‡‘ç‰§å ´", k:"í™©ê¸ˆëª©ì¥", t:"res"},
                            {n:"è’è¬¬çš„ç”Ÿè‚‰", k:"ì—‰í„°ë¦¬ìƒê³ ê¸°", t:"walk"}
                        ]
                    }
                ]
            },
            { 
                d: 2, date: "1/26 (ä¸€)", title: "å¤å®® & æ‰¹ç™¼",
                items: [
                    { time:"09:30", title:"æ™¯ç¦å®®", desc:"ç©¿éŸ“æœé€²å ´å…è²» (é ç´„9:30)", map:"ê²½ë³µê¶" },
                    { 
                        time:"12:00", type:"meal", title:"åˆé¤ï¼šè¥¿æ‘ç¾é£Ÿ", 
                        opts:[
                            {n:"åœŸä¿—æ‘è”˜é›æ¹¯", k:"í† ì†ì´Œ", t:"walk"},
                            {n:"ç½é ­é¤ƒå­", k:"ê¹¡í†µë§Œë‘", t:"app"},
                            {n:"é€šä»å¸‚å ´", k:"í†µì¸ì‹œì¥", t:"walk"}
                        ]
                    },
                    { title:"Folnua", desc:"åˆäº•ç«™ Showroom è²·åŒ…åŒ…", map:"í´ë‰´ì•„ ì‡¼ë£¸", brands:["Folnua"] },
                    { 
                        time:"17:00", type:"meal", title:"æ™šé¤ï¼šåˆäº•/æ±å¤§é–€", 
                        opts:[
                            {n:"å±‹åŒé£Ÿ", k:"ì˜¥ë™ì‹", t:"app"},
                            {n:"çµ¦è±šçš„ç”·äºº", k:"ëˆì£¼ëŠ”ë‚¨ì", t:"walk"},
                            {n:"æ©‹æ‘ç‚¸é›", k:"êµì´Œì¹˜í‚¨", t:"walk"}
                        ]
                    },
                    { 
                        time:"19:00", title:"æ±å¤§é–€æ‰¹ç™¼", desc:"æ™šä¸Š8é»å¾Œé–‹å§‹ç†±é¬§", map:"apM PLACE",
                        brands: ["apM PLACE", "nuZZon", "nyu.nyu"]
                    }
                ]
            },
            { 
                d: 3, date: "1/27 (äºŒ)", title: "è¿‘éƒŠéŠ",
                items: [
                    { time:"08:00", title:"é›†åˆå‡ºç™¼", desc:"å—æ€¡å³¶ / æ»‘é›ªè¡Œç¨‹" },
                    { time:"12:00", type:"meal", title:"åˆé¤", opts:[{n:"æ˜¥å·è¾£ç‚’é›æ’", k:"", t:"walk"}] },
                    { 
                        type:"choice", title:"å¤œæ™šäºŒé¸ä¸€", desc:"çœ‹é«”åŠ›æ±ºå®š",
                        choices: [
                            {n:"A æ–¹æ¡ˆ", desc:"å›æ˜æ´åƒç‚¸é›", target:"BHCì¹˜í‚¨ ëª…ë™ë³¸ì "},
                            {n:"B æ–¹æ¡ˆ", desc:"ä¸Šå—å±±å¡”çœ‹å¤œæ™¯", target:"ë‚¨ì‚°ì„œìš¸íƒ€ì›Œ"}
                        ]
                    }
                ]
            },
            { 
                d: 4, date: "1/28 (ä¸‰)", title: "æ±Ÿå—æ½®æµ",
                items: [
                    { 
                        time:"11:00", title:"ç‹é·—äº­æ½®ç‰Œ", desc:"å³¶å±±å…¬åœ’å¿…é€›", map:"ìŠˆí”„ë¦¼ ë„ì‚°",
                        brands: ["Supreme", "StÃ¼ssy", "Human Made", "Haus Dosan"]
                    },
                    { 
                        time:"13:00", type:"meal", title:"åˆé¤ï¼šå³¶å±±å…¬åœ’", 
                        opts:[
                            {n:"London Bagel", k:"ëŸ°ë˜ë² ì´ê¸€ë®¤ì§€ì—„", t:"app"},
                            {n:"Gino's Pizza", k:"ì§€ë…¸ìŠ¤í”¼ì", t:"res"},
                            {n:"Dosan Bunsik", k:"ë„ì‚°ë¶„ì‹", t:"walk"}
                        ]
                    },
                    { 
                        time:"14:30", type:"choice", title:"ä¸‹åˆäºŒé¸ä¸€", desc:"æƒ³æ‚ é–’é‚„æ˜¯æƒ³é€›è¡—?",
                        choices: [
                            {n:"A æ–¹æ¡ˆ", desc:"ç•™åœ¨å³¶å±±åƒ Nudake", target:"ëˆ„ë°ì´í¬"},
                            {n:"B æ–¹æ¡ˆ", desc:"å»è–æ°´æ´é€› Dior/ADER", target:"ì„±ìˆ˜ë™"}
                        ]
                    },
                    { time:"18:00", type:"meal", title:"æ™šé¤å›æ˜æ´", opts:[{n:"å…ƒå ‚é¦¬éˆ´è–¯æ¹¯", k:"ì›ë‹¹ê°ìíƒ•", t:"walk"}]}
                ]
            },
            { 
                d: 5, date: "1/29 (å››)", title: "å‹•ç‰©åœ’ & ç¾ä»£",
                items: [
                    { time:"10:30", title:"Zoolung Zoolung", desc:"æ°¸ç™»æµ¦å®¤å…§å‹•ç‰©åœ’", map:"ì£¼ë ì£¼ë  ì˜ë“±í¬" },
                    { 
                        time:"12:30", type:"meal", title:"åˆé¤ï¼šå•†å ´å…§", 
                        opts:[{n:"é¼æ³°è±", k:"ë”˜íƒ€ì´í‘", t:"res"}, {n:"Shake Shack", k:"ì‰ì´í¬ì‰‘", t:"walk"}]
                    },
                    { 
                        time:"15:00", title:"ç¾ä»£ç™¾è²¨", desc:"æ±çŸ£å³¶ B2", map:"ë”í˜„ëŒ€ ì„œìš¸",
                        brands: ["Matin Kim", "Marithe", "Covernat", "Arket"]
                    },
                    { time:"19:00", type:"meal", title:"æ™šé¤ï¼šç™¾è²¨å…§", opts:[{n:"Eataly", k:"ì´íƒˆë¦¬", t:"res"}, {n:"SMT Lounge", k:"SMTë¼ìš´ì§€", t:"res"}] }
                ]
            },
            { 
                d: 6, date: "1/30 (äº”)", title: "çµ‚æ¥µæ¡è³¼",
                items: [
                    { 
                        time:"09:30", title:"å—å¤§é–€ç«¥è£", desc:"åªæ”¶ç¾é‡‘ï¼", map:"ë‚¨ëŒ€ë¬¸ì‹œì¥ ì•„ë™ë³µê±°ë¦¬",
                        brands: ["Burdeng", "Mama", "Porky"]
                    },
                    { 
                        time:"12:00", type:"meal", title:"åˆé¤å¿…åƒ", 
                        opts:[
                            {n:"JoJo è›¤èœŠåˆ€å‰Šéºµ", k:"ì¡°ì¡°ì¹¼êµ­ìˆ˜ ì‹œì²­ì ", t:"walk", tip:"ğŸ”¥å¿…åƒ"},
                            {n:"éŸ“é †å­å¥¶å¥¶", k:"í•œìˆœìí• ë¨¸ë‹ˆì†ì¹¼êµ­ìˆ˜", t:"walk"},
                            {n:"å¯Œæ‘ç”Ÿæ‹Œç‰›è‚‰", k:"ë¶€ì´Œìœ¡íšŒ", t:"walk"}
                        ]
                    },
                    { time:"13:30", title:"å»£è—å¸‚å ´", desc:"æ£‰è¢« (è«‹è€é—†çœŸç©ºå£“ç¸®)", map:"ê´‘ì¥ì‹œì¥" },
                    { time:"14:30", title:"æ¨‚å¤©è¶…å¸‚", desc:"é¦–çˆ¾ç«™æ¡è³¼", map:"ë¡¯ë°ë§ˆíŠ¸ ì„œìš¸ì—­ì " },
                    { time:"19:00", type:"meal", title:"æ™šé¤ï¼šä¸€éš»é›", opts:[{n:"é™³ç‰è¯å¥¶å¥¶", k:"ì§„ì˜¥í™”í• ë§¤ì›ì¡°ë‹­í•œë§ˆë¦¬", t:"walk"}] }
                ]
            },
            { 
                d: 7, date: "1/31 (å…­)", title: "å›å®¶",
                items: [
                    { time:"08:30", title:"Check-out", desc:"æ­æ©Ÿå ´å·´å£«å‰å¾€ä»å·" },
                    { time:"11:00", title:"é ˜å–å…ç¨…å“", desc:"å…¥é—œå¾Œé ˜å–" },
                    { time:"12:00", title:"èµ·é£› CI0165", desc:"å¹³å®‰å›å®¶" }
                ]
            }
        ];

        // --- Logic ---
        
        let currentDayIdx = 0; 
        let rate = 0.024; 

        function init() {
            renderDaySlider();
            renderDayContent(0);
            updateWeather();
            updateRate();
        }

        function renderDaySlider() {
            const slider = document.getElementById('day-slider');
            slider.innerHTML = itinerary.map((d, i) => `
                <div class="day-chip ${i === 0 ? 'active' : ''}" onclick="selectDay(${i}, this)">
                    <span class="day-chip-num">Day ${d.d}</span>
                    <span class="day-chip-date">${d.date.split(' ')[0]}</span>
                </div>
            `).join('');
        }

        function selectDay(index, el) {
            currentDayIdx = index;
            document.querySelectorAll('.day-chip').forEach(c => c.classList.remove('active'));
            el.classList.add('active');
            el.scrollIntoView({behavior: 'smooth', block: 'nearest', inline: 'center'});
            
            const content = document.getElementById('day-content');
            content.style.opacity = '0';
            content.style.transform = 'scale(0.98)';
            setTimeout(() => {
                renderDayContent(index);
                content.style.opacity = '1';
                content.style.transform = 'scale(1)';
            }, 150);
        }

        function renderDayContent(index) {
            const data = itinerary[index];
            const container = document.getElementById('day-content');
            
            let html = `
                <div class="ios-card" style="padding:16px; margin-bottom:16px; background:#FAFAFA; border:none;">
                    <div style="font-size:22px; font-weight:800; color:var(--text-main); margin-bottom:4px;">${data.title}</div>
                    <div style="font-size:14px; color:var(--text-sub);">${data.date}</div>
                </div>
            `;

            data.items.forEach(ev => {
                if (ev.type === 'meal') {
                    // é¤å»³å¡ç‰‡
                    html += `
                    <div class="ios-card">
                        <div style="padding:16px; border-bottom:0.5px solid rgba(0,0,0,0.05); display:flex; justify-content:space-between; align-items:center;">
                            <div class="item-title"><i class="fa-solid fa-utensils" style="color:#D4A373;"></i> ${ev.title}</div>
                            ${ev.time ? `<span style="font-size:12px; font-weight:700; color:var(--text-sub); background:#F2F2F7; padding:4px 8px; border-radius:6px;">${ev.time}</span>` : ''}
                        </div>
                        <div>
                            ${ev.opts.map(opt => {
                                let bClass = opt.t === 'app' ? 'tag-gray' : (opt.t === 'res' ? 'tag-green' : 'tag-red');
                                let bText = opt.t === 'app' ? 'App' : (opt.t === 'res' ? 'é ç´„' : 'æ’éšŠ');
                                let link = opt.k ? `https://m.map.naver.com/search2/search.naver?query=${encodeURIComponent(opt.k)}` : '#';
                                return `
                                <a href="${link}" target="_blank" class="ios-list-item">
                                    <div class="item-content">
                                        <div style="font-weight:600; font-size:15px; margin-bottom:2px;">${opt.n}</div>
                                        <div style="font-size:12px; color:var(--text-sub);">${opt.tip || ''}</div>
                                    </div>
                                    <div class="item-meta">
                                        <span class="tag ${bClass}">${bText}</span>
                                        <div class="btn-icon"><i class="fa-solid fa-location-arrow" style="font-size:12px;"></i></div>
                                    </div>
                                </a>`;
                            }).join('')}
                        </div>
                    </div>`;
                } else if (ev.type === 'choice') {
                    // æŠ‰æ“‡å¡ç‰‡
                    html += `
                    <div class="ios-card" style="border: 2px dashed var(--border); background:#FAFAFA;">
                        <div style="text-align:center; font-weight:700; color:var(--primary); margin:12px 0;">${ev.title}</div>
                        ${ev.choices.map((c, idx) => `
                        <a href="https://m.map.naver.com/search2/search.naver?query=${encodeURIComponent(c.target)}" target="_blank" class="ios-list-item">
                            <div class="item-content">
                                <span style="font-size:10px; font-weight:800; background:${idx===0?'var(--text-main)':'var(--primary)'}; color:white; padding:2px 6px; border-radius:4px; margin-right:6px;">${c.n}</span>
                                <span style="font-weight:600;">${c.desc}</span>
                            </div>
                            <div class="btn-icon"><i class="fa-solid fa-chevron-right" style="font-size:12px; color:#ccc;"></i></div>
                        </a>`).join('')}
                    </div>`;
                } else {
                    // ä¸€èˆ¬å¡ç‰‡
                    let link = ev.map ? `https://m.map.naver.com/search2/search.naver?query=${encodeURIComponent(ev.map)}` : null;
                    html += `
                    <div class="ios-card">
                        <div class="ios-list-item" style="cursor:default;">
                            <div class="item-content">
                                <div class="item-title">${ev.title}</div>
                                <div class="item-desc">${ev.desc}</div>
                                ${ev.brands ? `
                                <div style="margin-top:10px; display:flex; flex-wrap:wrap; gap:6px;">
                                    ${ev.brands.map(b => `<span style="font-size:11px; background:#F2F2F7; padding:4px 8px; border-radius:6px; color:var(--text-main); font-weight:500;">${b}</span>`).join('')}
                                </div>` : ''}
                            </div>
                            <div style="text-align:right;">
                                ${ev.time ? `<div style="font-size:12px; font-weight:700; color:var(--text-sub); margin-bottom:8px;">${ev.time}</div>` : ''}
                                ${link ? `<div onclick="window.open('${link}')" class="btn-icon"><i class="fa-solid fa-location-arrow"></i></div>` : ''}
                            </div>
                        </div>
                    </div>`;
                }
            });

            container.innerHTML = html;
        }

        // --- Utils ---
        function switchView(viewId, btn) {
            ['plan', 'calc', 'guide'].forEach(id => document.getElementById('view-'+id).classList.add('hidden'));
            document.getElementById('view-'+viewId).classList.remove('hidden');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            window.scrollTo(0,0);
        }

        function calculateAll() {
            const inputVal = document.getElementById('calc-input').value;
            const val = parseFloat(inputVal.replace(/[^0-9.]/g, ''));
            
            if (isNaN(val) || inputVal === '') {
                document.getElementById('res-twd').innerText = '0';
                document.getElementById('res-tax').innerText = '0';
                return;
            }
            
            document.getElementById('res-twd').innerText = Math.round(val * rate).toLocaleString();
            let r = 0;
            if (val >= 30000 && val < 50000) r = 1500;
            else if (val >= 50000 && val < 75000) r = 3500;
            else if (val >= 75000 && val < 100000) r = 5000;
            else if (val >= 100000) r = Math.floor(val * 0.06);
            document.getElementById('res-tax').innerText = 'â‚© ' + r.toLocaleString();
        }

        async function updateWeather() {
            try {
                const timeoutPromise = new Promise((_, reject) => setTimeout(() => reject(new Error('Timeout')), 5000));
                const fetchPromise = fetch('https://api.open-meteo.com/v1/forecast?latitude=37.5665&longitude=126.9780&current=temperature_2m,weather_code&timezone=Asia%2FSeoul');
                const res = await Promise.race([fetchPromise, timeoutPromise]);
                
                if (!res.ok) throw new Error('API Error');

                const d = await res.json();
                const temp = Math.round(d.current.temperature_2m);
                const code = d.current.weather_code;
                let icon = 'fa-sun';
                if(code > 2) icon = 'fa-cloud';
                if(code >= 50) icon = 'fa-umbrella';
                document.getElementById('weather-widget').innerHTML = `<i class="fa-solid ${icon}" style="color:var(--primary);"></i> <span>é¦–çˆ¾ ${temp}Â°C</span>`;
            } catch(e) {
                document.getElementById('weather-widget').innerHTML = `<span>é¦–çˆ¾ä¹‹æ—…</span>`;
            }
        }

        function updateRate() {
            fetch('https://api.exchangerate-api.com/v4/latest/KRW')
                .then(r => r.ok ? r.json() : Promise.reject())
                .then(d => { 
                    if(d.rates && d.rates.TWD) {
                        rate = d.rates.TWD;
                        document.getElementById('rate-display').innerText = rate.toFixed(4);
                    }
                })
                .catch(() => {});
        }

        function copy(text) {
            // iOS å‰ªè²¼æ¿ç›¸å®¹æ€§è™•ç†
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(showToast).catch(() => fallbackCopy(text));
            } else {
                fallbackCopy(text);
            }
        }

        function fallbackCopy(text) {
            try {
                const ta = document.createElement("textarea");
                ta.value = text;
                ta.style.position = "fixed"; 
                document.body.appendChild(ta);
                ta.focus(); ta.select();
                document.execCommand('copy');
                document.body.removeChild(ta);
                showToast();
            } catch (err) {}
        }

        function showToast() {
            const t = document.getElementById('toast');
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 2000);
        }

        function modal(big, sub) {
            document.getElementById('m-big').innerText = big;
            document.getElementById('m-sub').innerText = sub;
            const modalEl = document.getElementById('modal');
            modalEl.style.display = 'flex';
            setTimeout(() => modalEl.classList.add('show'), 10);
        }
        
        function closeModal() {
            const modalEl = document.getElementById('modal');
            modalEl.classList.remove('show');
            setTimeout(() => modalEl.style.display = 'none', 200);
        }

        window.onload = init;
    </script>
</body>
</html>


